# AWS Runbooks

The following table lists the policies that the AWS Lambda you deploy will auto-remediate out-of-the-box.

> Note: The runbooks with no associated Prisma Cloud policy descriptor are generic runbooks you can associate a relevant custom policy to by modifying `index_prisma.py`.

Click on a runbook name to see more details, such as the IAM permissions required to run it as well as the script itself.


   |                                                           Runbook                                                           | Prisma Cloud Policy Name                                                                      | Prisma Cloud Policy Descriptor |    CIS     |        Prisma Cloud Policy ID        |
   | :-------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------- | :----------------------------: | :--------: | :----------------------------------: |
   |                                                     **CloudFormation**                                                      |                                                                                               |                                |            |                                      |
   |                    [AWS-CFM-003](runbook_details.md#enable-cloudformation-stack-termination-protection)                     | Enable CloudFormation Stack termination protection                                            |              N/A               |            |                 N/A                  |
   |                                                       **CloudTrail**                                                        |                                                                                               |                                |            |                                      |
   |           [AWS-CLT-002](runbook_details.md#aws-cloudtrail-logs-are-not-encrypted-using-customer-master-keys-cmks)           | AWS CloudTrail logs are not encrypted using Customer Master Keys (CMKs)                       |          PC-AWS-CT-5           |    2.7     | c2b84f89-7ec8-473e-a6af-404feeeb96c5 |
   |                  [AWS-CLT-004](runbook_details.md#cloudtrail-trail-is-not-integrated-with-cloudwatch-logs)                  | CloudTrail trail is not integrated with CloudWatch Logs                                       |          PC-AWS-CT-50          |    2.4     | 0d07ac51-fbfe-44fe-8edb-3314c9995ee0 |
   |                [AWS-CLT-005](runbook_details.md#aws-cloudtrail-log-validation-is-not-enabled-in-all-regions)                | AWS CloudTrail log validation is not enabled in all regions                                   |          PC-AWS-CT-4           |    2.2     | 38e3d3cf-b694-46ec-8bd2-8f02194b5040 |
   |                       [AWS-CLT-006](runbook_details.md#aws-cloudtrail-bucket-is-publicly-accessible)                        | AWS CloudTrail bucket is publicly accessible                                                  |          PC-AWS-S3-1           |    2.3     | b76ad441-e715-4fd0-bbc3-cd3b2bee34bf |
   |                                                         **Config**                                                          |                                                                                               |                                |            |                                      |
   |                                  [AWS-CONFIG-001](runbook_details.md#aws-config-disabled)                                   | AWS Config disabled                                                                           |              N/A               |    2.5     |                 N/A                  |
   |                                                           **EC2**                                                           |                                                                                               |                                |            |                                      |
   |                    [AWS-EC2-001](runbook_details.md.md#ebs-snapshot-doesnt-exist-or-older-than-15-days)                     | EBS snapshot doesn't exist or older than 15 days                                              |              N/A               |            |                 N/A                  |
   |               [AWS-EC2-002](runbook_details.md.md#aws-security-groups-allow-internet-traffic-to-ssh-port-22)                | AWS Security Groups allow internet traffic to SSH port (22)                                   |         PC-AWS-VPC-23          |    4.1     | 617b9138-584b-4e8e-ad15-7fbabafbed1a |
   |       [AWS-EC2-003](runbook_details.md.md#aws-security-groups-allow-internet-traffic-from-internet-to-telnet-port-23)       | AWS Security Groups allow internet traffic from internet to Telnet port (23)                  |         PC-AWS-VPC-236         |            | 519456f2-f9eb-407b-b32d-064f1ac7f0ca |
   |       [AWS-EC2-004](runbook_details.md.md#aws-security-groups-allow-internet-traffic-from-internet-to-rdp-port-3389)        | AWS Security Groups allow internet traffic from internet to RDP port (3389)                   |         PC-AWS-VPC-24          |    4.2     | b82f90ce-ed8b-4b49-970c-2268b0a6c2e5 |
   |        [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-mysql-port-3306)        | AWS Security Groups allow internet traffic from internet to MYSQL port (3306)                 |         PC-AWS-VPC-229         |            | 65daa6a0-e040-434e-aca3-9d5765c96e7c |
   |     [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-postgresql-port-5432)      | AWS Security Groups allow internet traffic from internet to PostgreSQL port (5432)            |         PC-AWS-VPC-230         |            | 3b642d25-4534-487a-9399-c2622754ecb5 |
   |      [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-sqlserver-port-1433)      | AWS Security Groups allow internet traffic from internet to SQLServer port (1433)             |         PC-AWS-VPC-233         |            | 760f2823-997e-495f-a538-5fb073c0ee78 |
   |        [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-msql-port-4333)         | AWS Security Groups allow internet traffic from internet to MSQL port (4333)                  |         PC-AWS-VPC-247         |            | ab7f8eda-18ab-457c-b5d3-fd4f53c722bc |
   |    [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-vnc-listener-port-5500)     | AWS Security Groups allow internet traffic from internet to VNC Listener port (5500)          |         PC-AWS-VPC-238         |            | 8dd9e369-0c09-4477-97a2-ff0d50507fe2 |
   |     [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-vnc-server-port-5900)      | AWS Security Groups allow internet traffic from internet to VNC Server port (5900)            |         PC-AWS-VPC-232         |            | 89cbc2f1-fcb0-48b9-be71-4cbe2d18a5f7 |
   |          [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-ftp-port-21)          | AWS Security Groups allow internet traffic from internet to FTP port (21)                     |         PC-AWS-VPC-245         |            | 14d10ad2-51df-4b07-be69-e94951cc7067 |
   |       [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-ftp-data-port-20)        | AWS Security Groups allow internet traffic from internet to FTP-Data port (20)                |         PC-AWS-VPC-248         |            | cdcd663c-e9c9-4472-9779-e5f38751524a |
   |         [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-smtp-port-25)          | AWS Security Groups allow internet traffic from internet to SMTP port (25)                    |         PC-AWS-VPC-227         |            | c2074d5a-aa28-4dde-90c1-82f528cec55e |
   |          [AWS-EC2-010](runbook_details.md#aws-security-groups-allow-internet-traffic-from-internet-to-dns-port-53)          | AWS Security Groups allow internet traffic from internet to DNS port (53)                     |         PC-AWS-VPC-228         |            | 6eaf6455-1659-4c4b-bff5-c8c7b0fda201 |
   |                           [AWS-EC2-031](runbook_details.md#aws-delete-unused-ec2-security-groups)                           | AWS delete unused EC2 Security Groups                                                         |              N/A               |            |                 N/A                  |
   |                    [AWS-EC2-036](runbook_details.md#aws-amazon-machine-image-ami-is-publicly-accessible)                    | AWS Amazon Machine Image (AMI) is publicly accessible                                         |         PC-AWS-EC2-35          |            | 81a2200a-c63e-4860-85a0-b54eaa581135 |
   |                 [AWS-EC2-038](runbook_details.md#aws-default-security-group-does-not-restrict-all-traffic)                  | AWS Default Security Group does not restrict all traffic                                      |         PC-AWS-VPC-22          |    4.3     | 2378dbf4-b104-4bda-9b05-7417affbba3f |
   |          [AWS-EC2-039](runbook_details.md#aws-security-groups-with-inbound-rule-overly-permissive-to-all-traffic)           | AWS Security Groups with Inbound rule overly permissive to All Traffic                        |         PC-AWS-VPC-222         |            | 566686e8-0581-4df5-ae22-5a901ed37b58 |
   |                        [AWS-EC2-042](runbook_details.md#aws-ebs-snapshots-are-accessible-to-public)                         | AWS EBS snapshots are accessible to public                                                    |         PC-AWS-EC2-31          |            | 7c714cb4-3d47-4c32-98d4-c13f92ce4ec5 |
   |                                                           **ELB**                                                           |                                                                                               |                                |            |                                      |
   |            [AWS-ELB-009](runbook_details.md#aws-elastic-load-balancer-classic-with-connection-draining-disabled)            | AWS Elastic Load Balancer (Classic) with connection draining disabled                         |         PC-AWS-ELB-267         |            | 7eb7f61e-df59-42d4-8236-7d012f278fa6 |
   |         [AWS-ELB-012](runbook_details.md#aws-elastic-load-balancer-classic-with-cross-zone-load-balancing-disabled)         | AWS Elastic Load Balancer (Classic) with cross-zone load balancing disabled                   |         PC-AWS-ELB-266         |            | 551ee7ba-edb6-468e-a018-8774da9b1e85 |
   |                [AWS-ELB-013](runbook_details.md#aws-elastic-load-balancer-classic-with-access-log-disabled)                 | AWS Elastic Load Balancer (Classic) with access log disabled                                  |         PC-AWS-ELB-265         |            | b675c604-e886-43aa-a60f-a9ad1f3742d3 |
   | [AWS-ELB-015](runbook_details.md#aws-elastic-load-balancer-v2-elbv2-application-load-balancer-alb-with-access-log-disabled) | AWS Elastic Load Balancer v2 (ELBv2) Application Load Balancer (ALB) with access log disabled |         PC-AWS-ELB-242         |            | f2a2bcf1-2966-4cb5-9230-bd39c9903a02 |
   |                                                           **IAM**                                                           |                                                                                               |                                |            |                                      |
   |                    [AWS-IAM-002](runbook_details.md#enforce-aws-account-best-practices-password-policy)                     | Enforce AWS account best practices password policy                                            |              N/A               | 1.5 - 1.11 |                 N/A                  |
   |                      [AWS-IAM-015](runbook_details.md#aws-access-keys-not-used-for-more-than-90-days)                       | AWS access keys not used for more than 90 days                                                |         PC-AWS-IAM-48          |    1.3     | 7ca5af2c-d18d-4004-9ad4-9c1fbfcab218 |
   |                   [AWS-IAM-016](runbook_details.md#aws-iam-policy-allows-full-administrative-privileges)                    | AWS IAM policy allows full administrative privileges                                          |         PC-AWS-IAM-46          |    1.22    | d9b86448-11a2-f9d4-74a5-f6fc590caeef |
   |              [AWS-IAM-018](runbook_details.md#create-an-iam-support-role-to-manage-incidents-with-aws-support)              | Create an IAM Support Role to manage incidents with AWS Support                               |              N/A               |    1.20    |                 N/A                  |
   |                                                           **KMS**                                                           |                                                                                               |                                |            |                                      |
   |                    [AWS-KMS-001](runbook_details.md#aws-customer-master-key-cmk-rotation-is-not-enabled)                    | AWS Customer Master Key (CMK) rotation is not enabled                                         |         PC-AWS-KMS-20          |    2.8     | 497f7e2c-b702-47c7-9a07-f0f6404ac896 |
   |                                                           **RDS**                                                           |                                                                                               |                                |            |                                      |
   |                     [AWS-RDS-005](runbook_details.md#aws-rds-database-instance-is-publicly-accessible)                      | AWS RDS database instance is publicly accessible                                              |         PC-AWS-RDS-99          |            | 1bb6005a-dca6-40e2-b0a6-24da968c0808 |
   |                        [AWS-RDS-007](runbook_details.md#aws-rds-snapshots-are-accessible-to-public)                         | AWS RDS snapshots are accessible to public                                                    |         PC-AWS-RDS-32          |            | a707de6a-11b7-478a-b636-5e21ee1f6162 |
   |                  [AWS-RDS-010](runbook_details.md#aws-rds-instance-with-multi-availability-zone-disabled)                   | AWS RDS instance with Multi-Availability Zone disabled                                        |         PC-AWS-RDS-218         |            | c5305272-a732-4e8e-8427-6a9701cd2a6f |
   |                            [AWS-RDS-011](runbook_details.md#aws-rds-minor-upgrades-not-enabled)                             | AWS RDS minor upgrades not enabled                                                            |         PC-AWS-RDS-260         |            | 9dd6cc35-1855-48c8-86ba-0e1818ce11e2 |
   |                                                        **Redshift**                                                         |                                                                                               |                                |            |                                      |
   |               [AWS-REDSHIFT-001](runbook_details.md#aws-redshift-clusters-should-not-be-publicly-accessible)                | AWS Redshift clusters should not be publicly accessible                                       |         PC-AWS-RED-79          |            | d65fd313-1c5c-42a1-98b2-a73bdeda19a6 |
   |                                                           **S3**                                                            |                                                                                               |                                |            |                                      |
   |                           [AWS-SSS-001](runbook_details.md#aws-s3-object-versioning-is-disabled)                            | AWS S3 Object Versioning is disabled                                                          |         PC-AWS-S3-259          |            | 89ea62c1-3845-4134-b337-cc82203b8ff9 |
   |                   [AWS-SSS-008](runbook_details.md#aws-s3-bucket-has-global-view-acl-permissions-enabled)                   | AWS S3 bucket has global view ACL permissions enabled                                         |         PC-AWS-S3-251          |            | 43c42760-5283-4bc4-ac43-a80e58c4139f |
   |                       [AWS-SSS-009](runbook_details.md#aws-access-logging-not-enabled-on-s3-buckets)                        | AWS Access logging not enabled on S3 buckets                                                  |          PC-AWS-S3-30          |    2.6     | 4daa435b-fa46-457a-9359-6a4b4a43a442 |
   |                     [AWS-SSS-014](runbook_details.md#aws-s3-buckets-do-not-have-server-side-encryption)                     | AWS S3 buckets do not have server side encryption                                             |          PC-AWS-S3-64          |            | 7913fcbf-b679-5aac-d979-1b6817becb22 |
   |                         [PC-AWS-S3-29](runbook_details.md#aws-s3-buckets-are-accessible-to-public)                          | AWS S3 buckets are accessible to public                                                       |          PC-AWS-S3-29          |            | 630d3779-d932-4fbf-9cce-6e8d793c6916 |
   |                                                           **VPC**                                                           |                                                                                               |                                |            |                                      |
   |                     [AWS-VPC-013](runbook_details.md#release-unassociated-unused-elastic-ip-addresses)                      | Release unassociated (unused) Elastic IP addresses                                            |              N/A               |            |                 N/A                  |
   |                              [AWS-VPC-020](runbook_details.md#aws-vpc-has-flow-logs-disabled)                               | AWS VPC has flow logs disabled                                                                |         PC-AWS-VPC-25          |    2.9     | 49f4760d-c951-40e4-bfe1-08acaa17672a |
   |                                [AWS-VPC-Default](runbook_details.md#delete-aws-default-vpc)                                 | Delete AWS default VPC                                                                        |              N/A               |            |                 N/A                  |
   |                                                          **Misc**                                                           |                                                                                               |                                |            |                                      |
   |                                     [AWS-TEST-001](runbook_details.md#example-runbook)                                      | Example runbook                                                                               |              N/A               |            |                 N/A                  |
